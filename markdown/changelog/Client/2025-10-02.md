# 🎃 HalloweenBot Changelog

## v5.2.1 (2025-10-02)

### 🕹️ Pumpkin Hunt (`/pumpkinhunt`)
- Starts a **pumpkin hunt** where a 🎃 appears on a random recent message from the last 20 minutes.  
- Excludes **voice and form channels** automatically.  
- The pumpkin reacts to the message for **30 seconds**.  
- If a user reacts with 🎃 in time:
  - They are awarded **5–15 points**.  
  - Bot announces the winner and links to the original message.  
- If no one reacts:
  - Bot announces in the original channel that no one caught the pumpkin, with a link to the missed message.  

---

### 👻 Ghostbuster (`/ghostbuster`)
- Spawns a **ghost** on a random recent message (last 20 minutes).  
- Stays for **30 seconds** before escaping if not caught.  
- **Rarity system with point rewards:**
  - 👻 **Common – Wandering Spirit:** 5–15 points  
  - 🧟 **Uncommon – Poltergeist:** 10–30 points  
  - 💀 **Rare – Demonic Phantom:** 20–60 points  
- First to react earns the ghost as an item in their **inventory** and gains points.  
- Announces result with an **embed** and message link.  

---

### ⚙️ Setup (`/setup`)
- Used to create and configure the **Daily Countdown** feature.  
- **Permission Check:** Bot now validates if it has the **Manage Webhooks** permission in the selected channel.  
- Provides feedback while checking:  
  - `"🔍 Checking channel permissions..."`  
  - `"✅ Permissions correct, setting up..."`  
  - or `"❌ Missing permissions: <list of missing perms>"`  

---

### 🎁 Event Config (`/seteventconfig`)
- Configure event channel and reward role.  
- **Permission Validation:**
  - Bot checks if it can **send messages** in the chosen channel.  
  - Bot checks if it has **Manage Roles** to assign the reward role.  
  - Replies with permission check messages before saving to DB.  
- Settings saved into `eventConfig` with:  
  - `channelId`, `rewardRoleId`, `enabled`, `eventRunning`, and `lastEventTimestamp`.  

---

### 📜 Config (`/config`)
- Displays full **server configuration** including:  
  - Guild ID, Guild Name, Locale, Timezone, Premium Status, Beta Access, Blacklisted Status, and Registered Status.  
- Now merged with **Daily Countdown** and **Event Config view**:  
  - Shows if **Daily Countdown** is enabled, time + timezone, and channel/webhook used.  
  - Shows **Event Config** (channel, reward role, enabled status).  
- Uses localized strings via `i18n`.  

---

### 🎒 Inventory (`/inventory`)
- Shows the user’s collected **Halloween items** and **points**.  
- Items displayed with **rarity emojis**:  
  - 🍬 Common  
  - 🧟 Uncommon  
  - 👑 Rare  
  - 🎁 Default/Other  
- Each item includes:  
  - Name, rarity, and **time collected** (`<t:...:R>` format).  
- Embed also shows:  
  - **Server ID**  
  - **Total Points**  

---

## 🛠️ Backend Changes
- **UserInventory schema fix:** now enforces unique `userId + guildId`.  
- **Improved logging** across commands for debugging.  

---

## 🎉 Summary
This update introduces **interactive mini-games** (Pumpkin Hunt & Ghostbuster), improves **setup/config workflows** with proper permission checks, and enhances the **inventory & event system** with rarity, points, and better embeds.  
