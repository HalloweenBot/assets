# ðŸŽƒ HalloweenBot Dashboard - Changelog

## ðŸ“¦ Version 3.1.0 â€” *September 10, 2025*

### âœ… Summary of Changes

#### ðŸ”§ API Updates
- **Added:** `/api/settings/changelog/[guildId]`  
  â†’ New endpoint to fetch the 50 most recent setting changes for a guild.
- **Improved:** `/api/settings/guild/[guildId]`  
  â†’ Now logs changes to `locale` and `timezone` using `SettingChangeLog`.
- **Improved:** `/api/settings/guild/[guildId]/daily-countdown.ts`  
  â†’ Saves new countdown settings, creates Discord webhook, and sends a test message.  
  â†’ Also logs the update to `SettingChangeLog`.

#### ðŸ’¾ Database / Logging
- Used `SettingChangeLog` model to track:
  - `guildId`, `settingKey`, `oldValue`, `newValue`, `changedBy`, `changedAt`, `username`, `userId`.
- Ensures traceability for all critical guild configuration updates.

#### ðŸ’» Dashboard Frontend
- **Updated:** `/dashboard/manage/[guildId]` page
  - Added: new **Settings Change Log** card component.
  - Displays who changed what setting, from what value to what, and when.
  - Uses `username`, `settingKey`, `oldValue`, `newValue`, `changedAt`.

#### ðŸ§ª Fixes & Debugging
- Fixed: JSON parse errors caused by incorrect response formatting.
- Fixed: Internal fetch was pointing to the wrong endpoint (`/settings/guild` instead of `/settings/changelog`).
- Improved: Handling of session and debug logging when no access or errors occur.

---


